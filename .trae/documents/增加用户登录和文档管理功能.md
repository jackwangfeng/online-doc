## 功能规划

### 1. 数据库设计
创建新的数据库 `doc_online_db`，包含以下表：
- **users** - 用户表（id, username, email, password_hash, created_at）
- **documents** - 文档表（id, title, owner_id, created_at, updated_at）
- **document_permissions** - 文档权限表（document_id, user_id, permission_type）

### 2. 后端功能（Node.js + Express + PostgreSQL）
- **用户认证 API**
  - POST `/api/auth/register` - 用户注册
  - POST `/api/auth/login` - 用户登录（返回 JWT Token）
  - GET `/api/auth/me` - 获取当前用户信息
  
- **文档管理 API**
  - GET `/api/documents` - 获取用户的文档列表
  - POST `/api/documents` - 创建新文档
  - GET `/api/documents/:id` - 获取文档信息
  - PUT `/api/documents/:id` - 更新文档
  - DELETE `/api/documents/:id` - 删除文档

- **WebSocket 连接验证**
  - 验证用户 Token 后才能连接文档协作

### 3. 前端功能（React）
- **登录/注册页面**
  - 用户注册表单
  - 用户登录表单
  
- **文档列表页面**
  - 显示用户的所有文档
  - 创建新文档按钮
  - 删除文档功能
  
- **文档编辑页面**
  - 通过 URL `/doc/:documentId` 直接访问
  - 保留原有的协作编辑功能

### 4. 技术栈
- **后端**: Express.js + pg (PostgreSQL 客户端) + jsonwebtoken + bcrypt
- **前端**: 现有的 React + React Router
- **数据库**: PostgreSQL（使用你提供的配置）

### 5. 需要安装的依赖
**Server:**
- express
- pg
- jsonwebtoken
- bcryptjs
- cors
- dotenv

**Client:**
- react-router-dom

### 6. 文件结构变更
```
doc_online/
├── server/
│   ├── index.js              # 主入口（整合 HTTP + WebSocket）
│   ├── db.js                 # 数据库连接
│   ├── routes/
│   │   ├── auth.js           # 认证路由
│   │   └── documents.js      # 文档路由
│   └── middleware/
│       └── auth.js           # JWT 验证中间件
├── client/
│   ├── src/
│   │   ├── App.tsx           # 添加路由
│   │   ├── pages/
│   │   │   ├── Login.tsx     # 登录页面
│   │   │   ├── Register.tsx  # 注册页面
│   │   │   ├── DocumentList.tsx  # 文档列表
│   │   │   └── EditorPage.tsx    # 编辑器页面
│   │   └── api/
│   │       └── index.ts      # API 调用封装
```

### 7. 数据库连接配置
```javascript
// 使用提供的数据库信息
const dbConfig = {
  host: 'localhost',
  port: 5432,
  user: 'quant_user',
  password: 'dahuangfeng.96',
  database: 'doc_online_db'  // 新建的数据库
}
```

请确认这个规划后，我将开始实施具体的代码修改。是否需要调整任何部分？